<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link rel="shortcut icon" type="image/x-icon" href="#{request.contextPath}/resources/plugins/images/slider/logo.gif"/>
        <h:outputScript name="bootstrap.min.js" library="bootstrap/js" target="body" />     
        <h:outputStylesheet name="bootstrap.css" library="bootstrap/css" /> 
        <h:outputStylesheet name="styleTables.css" library="plugins/css" /> 
        <f:loadBundle basename="com.tesis.properties.messages" var="msg"/>
        <h:outputStylesheet name="bootstrap.min.css" library="plugins/css/theme" />
        <h:outputStylesheet name="main.css" library="plugins/css/theme" />
        <h:outputStylesheet name="font-awesome.css" library="bootstrap/font-awesome/css" />
        <h:outputScript target="body" >
            function llamarFile() {
            document.getElementById('formulario:file-input').click();
            document.getElementById("formulario:file-input").onchange = function(e) {
            addImage(e);
            }
            }
            function addImage(e) {
            var file = e.target.files[0],
            imageType = /image.*/;

            if (!file.type.match(imageType))
            return;

            var reader = new FileReader();
            reader.onload = fileOnload;
            reader.readAsDataURL(file);
            }

            function fileOnload(e) {
            var result = e.target.result;
            document.getElementById("formulario:imgSalida").src = result;
            }

            function deleteImg() {
            document.getElementById("formulario:imgSalida").src =  "/TesisAplication/faces/javax.faces.resource/image.png?ln=plugins/images";
            document.getElementById("formulario:file-input").value = "";
            }

        </h:outputScript> 
    </h:head>
    <h:body>
        <ui:include src="headerAdministration.xhtml" />
        <section>
            <div class="container">

                <div class="row row-offcanvas row-offcanvas-right">

                    <p class="pull-right visible-xs">
                        <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
                    </p>
                    <div class="jumbotron">
                        <h2>Administraci&oacute;n de Sistema!</h2>
                        <p>Seleccione la oferta acad&eacute;mica que desea actualizar.</p>
                    </div>
                    <p:messages id="mensaje" closable="true"></p:messages>
                    <div>
                        <h:form id="form1" >
                            <div class="">
                                <h4>Exportar Datos</h4>
                                <h:commandLink>
                                    <p:graphicImage name="excel213.png" library="plugins/images" class="btn btn-default"/>
                                    <p:dataExporter type="xls" target="list_offer" fileName="list_offer" />
                                </h:commandLink>

                                <h:commandLink>
                                    <p:graphicImage name="adobe2013.png" library="plugins/images" class="btn btn-default"/>
                                    <p:dataExporter type="pdf" target="list_offer" fileName="list_offer" />
                                </h:commandLink>
                            </div>
                            <p:dataTable value="#{update_offer.list}" var="row" class="table table-hover" id="list_offer" 
                                         emptyMessage="No se encontraron registros..." rows="10"
                                         paginator="true" paginatorPosition="bottom"
                                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                         rowsPerPageTemplate="10"
                                         rowKey="#{row.codTesisOffer}"
                                         widgetVar= "offer_list"
                                         >
                                <p:column class="info" headerText="Acción" styleClass="tableHeader" style="table-layout: fixed">
                                    <p:commandLink class="btn btn-default fa fa-pencil" type="button" onclick="PF('dlg2').show();" style="width: 46px;" update=":formulario" >
                                        <f:setPropertyActionListener target="#{update_offer.offer_select}" value="#{row}" />
                                    </p:commandLink>
                                </p:column>

                                <p:column class="info" styleClass="tableHeader" filterBy="#{row.offerName}">
                                    <f:facet name="header">
                                        <h:outputText value="Nombre" style="margin-left: 12px;"/>
                                    </f:facet>
                                    <h:outputText value="#{row.offerName}"/>
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Imagen"/>
                                    </f:facet>
                                    <h:graphicImage class="img-rounded" library="#{row.fkTesisSystemImage.imageUri}" name="#{row.fkTesisSystemImage.imageDescription}" width="100px" height="90px"/>
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Documento"/>
                                    </f:facet>
                                    <p:commandLink action="#{update_offer.downloadArchivo()}" ajax="false">
                                        <h:outputText value="#{row.fkTesisSystemDocument.documentDescription}" style="color: rgb(35, 35, 171);"/>
                                        <f:setPropertyActionListener target="#{update_offer.offer_select}" value="#{row}" />
                                    </p:commandLink>
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Campus"/>
                                    </f:facet>
                                    <h:outputText value="#{row.fkTesisCampus.campusName}"/>
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Creado por"/>
                                    </f:facet>
                                    <h:outputText value="#{row.createdBy}"/>
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Creación"/>
                                    </f:facet>
                                    <h:outputText value="#{row.createdDate.date}-#{row.createdDate.month+1}-#{row.createdDate.year+1900} #{row.createdDate.hours}:#{row.createdDate.minutes}:#{row.createdDate.seconds}" />
                                </p:column>
                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Actualizado por"/>
                                    </f:facet>
                                    <h:outputText value="#{row.updateBy}"/>
                                </p:column>

                                <p:column styleClass="tableHeader">
                                    <f:facet name="header">
                                        <h:outputText value="Actualización"/>
                                    </f:facet>
                                    <h:outputText value="#{row.updateDate.date}-#{row.updateDate.month+1}-#{row.updateDate.year+1900} #{row.updateDate.hours}:#{row.updateDate.minutes}:#{row.updateDate.seconds}" />
                                </p:column>

                            </p:dataTable>
                        </h:form>
                    </div>
                </div>

                <div>
                    <h:link class="btn btn-primary" outcome="#{admin_controller.dashBoard}" value="Regresar"></h:link>
                </div>

                <p:dialog header="Modificar Oferta Académica" widgetVar="dlg2" modal="true" id="diag" style="position: absolute;" class="modal-sm" width="550px" resizable="false">
                    <h:form enctype="multipart/form-data" id="formulario">
                        <div class="">
                            <div>
                                <div class="col-md-6">
                                    <h:graphicImage class="img-rounded" library="#{update_offer.offer_select.fkTesisSystemImage.imageUri}" name="#{update_offer.offer_select.fkTesisSystemImage.imageDescription}" width="120px" height="100px" id="imgSalida"/>
                                    <div> 
                                        <p:commandButton icon="ui-icon-image" id="cargar" onclick="llamarFile();" ></p:commandButton>
                                        <p:commandButton icon="ui-icon-closethick" id="eliminar" onclick="deleteImg();"></p:commandButton>
                                        <h:inputFile id="file-input" style="display: none" value="#{update_offer.image}">
                                            <f:validator validatorId="FileUploadValidator" />
                                        </h:inputFile>
                                    </div>
                                </div>
                                <div class="col-md-4" style="height: 140px;">
                                    <label for="campus">Campus: </label>
                                    <h:selectOneMenu id="campus" class="form-control" >
                                        <f:selectItem id="item1" itemLabel="UES FMOCC" itemValue="1" />
                                    </h:selectOneMenu>
                                </div>

                            </div>
                            <div style="padding-top: 10px;">
                                <label for="text">Archivo Cargado: </label>
                                <h:outputText id="text" value="#{update_offer.offer_select.fkTesisSystemDocument.documentDescription}" class="form-control"/>
                            </div>
                            <div>
                                <label for="anexo">Reemplazar Archivo: </label>
                                <h:inputFile id="anexo" class="form-control" value="#{update_offer.newfile}"/>
                            </div>
                             <div>
                                <label for="nombreOfer">Nombre: </label>
                                <h:inputText id="nombreOfer" value="#{update_offer.offer_select.offerName}" class="form-control" p:placeholder="Nombre de Oferta Académica" required="true"></h:inputText>
                            </div>
                            
                            <div>
                                <label for="ModeOfer">Modalidad: </label>
                                <h:inputText id="ModeOfer" value="#{update_offer.offer_select.offerMode}" class="form-control" p:placeholder="Modalidad" required="true"></h:inputText>
                            </div>
                            
                            <div>
                                <label for="areaOfer">&Aacute;rea: </label>
                                <h:selectOneMenu id="areaOfer" class="form-control" value="#{update_offer.offer_select.offerArea}">
                                    <f:selectItem id="itemMed" itemLabel="Departamento de Medicina" itemValue="Departamento de Medicina" />   
                                    <f:selectItem id="itemJur" itemLabel="Departamento de Ciencias Jur&iacute;dicas" itemValue="Departamento de Ciencias Jur&iacute;dicas" />  
                                    <f:selectItem id="itemSoc" itemLabel="Departamento de Ciencias Sociales, Filosofia y Letras" itemValue="Departamento de Ciencias Sociales, Filosofia y Letras" />  
                                    <f:selectItem id="itemIdi" itemLabel="Departamento de Idiomas" itemValue="Departamento de Idiomas" />  
                                    <f:selectItem id="itemIng" itemLabel="Departamento de Ingenier&iacute;a" itemValue="Departamento de Ingenier&iacute;a" />
                                    <f:selectItem id="itemEcono" itemLabel="Departamento de Ciencias Econ&oacute;micas" itemValue="Departamento de Ciencias Econ&oacute;micas" />
                                    <f:selectItem id="itemQu" itemLabel="Departamento de Qu&iacute;mica" itemValue="Departamento de Qu&iacute;mica" />
                                    <f:selectItem id="itemBio" itemLabel="Departamento de Biolog&iacute;a" itemValue="Departamento de Biolog&iacute;a" />
                                    <f:selectItem id="itemFisica" itemLabel="Departamento de Fisica" itemValue="Departamento de Fisica" />
                                    <f:selectItem id="itemMat" itemLabel="Departamento de Matem&aacute;tica" itemValue="Departamento de Matem&aacute;tica" />
                                </h:selectOneMenu>
                            </div>

                            <div>
                                <label for="clicloOfer">Ciclos: </label>
                                <h:inputText id="clicloOfer" value="#{update_offer.offer_select.offerCycles}" class="form-control" p:placeholder="Número de Ciclos" required="true"></h:inputText>
                            </div>
                            
                             <div>
                                <label for="planOfer">Plan de Estudio: </label>
                                <h:inputText id="planOfer" value="#{update_offer.offer_select.offerStudyPlan}" class="form-control" p:placeholder="Plan de Estudio" required="true"></h:inputText>
                            </div>
                            <div>
                                <label for="reqOfer">Requisitos: </label>
                                <h:inputTextarea id="reqOfer" value="#{update_offer.offer_select.offerRequirement}" class="form-control" p:placeholder="Requisitos"
                                                 rows="3">
                                </h:inputTextarea>
                            </div>
                             <div>
                                 <label for="desOfer">Descripci&oacute;n: </label>
                                 <h:inputTextarea id="desOfer" value="#{update_offer.offer_select.offerDescription}" class="form-control" p:placeholder="Descripci&oacute;n"
                                                 rows="3">
                                </h:inputTextarea>
                            </div>

                        </div>
                        <div class="" style="margin-left: 300px;">
                            <div class="">
                                <h:commandButton class="btn btn-primary"  action="#{update_offer.actualizar()}" value="Guardar"  style="margin-top: 0px;">
                                </h:commandButton>
                                <button class="btn btn-default" onclick="PF('dlg2').hide();">Cancelar</button>
                            </div>
                        </div>
                    </h:form>
                </p:dialog> 
            </div>

        </section>
    </h:body>
</html>

